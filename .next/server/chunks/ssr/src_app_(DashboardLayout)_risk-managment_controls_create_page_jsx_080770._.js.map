{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/app/(DashboardLayout)/risk-managment/controls/create/page.jsx"],"sourcesContent":["\"use client\";\r\nimport * as React from 'react';\r\nimport { \r\n  Box, \r\n  Typography, \r\n  Button, \r\n  Paper,\r\n  Snackbar,\r\n  Alert\r\n} from '@mui/material';\r\nimport { useRouter } from 'next/navigation';\r\nimport { IconArrowLeft, IconDeviceFloppy } from '@tabler/icons-react';\r\nimport ControlForm from '@/app/components/risk-managment/ControlForm';\r\n\r\nexport default function CreateControlPage() {\r\n  const router = useRouter();\r\n  const [users, setUsers] = React.useState([]);\r\n  const [isLoading, setIsLoading] = React.useState(false);\r\n  const [snackbar, setSnackbar] = React.useState({\r\n    open: false,\r\n    message: '',\r\n    severity: 'success'\r\n  });\r\n  const apiBaseUrl = 'http://4.222.232.224/api/v1';\r\n\r\nasync function fetchData(endpoint) {\r\n  const response = await fetch(`${apiBaseUrl}${endpoint}`);\r\n  if (!response.ok) throw new Error('Network response was not ok');\r\n  return response.json();\r\n}\r\n\r\nasync function postData(endpoint, data) {\r\n  const response = await fetch(`${apiBaseUrl}${endpoint}`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'accept': '*/*'\r\n    },\r\n    body: JSON.stringify(data)\r\n  });\r\n  if (!response.ok) throw new Error('Network response was not ok');\r\n  return response.json();\r\n}\r\n\r\nasync function putData(endpoint, data) {\r\n  const response = await fetch(`${apiBaseUrl}${endpoint}`, {\r\n    method: 'PUT',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'accept': '*/*'\r\n    },\r\n    body: JSON.stringify(data)\r\n  });\r\n  if (!response.ok) throw new Error('Network response was not ok');\r\n  return response.json();\r\n}\r\n\r\nasync function deleteData(endpoint) {\r\n  const response = await fetch(`${apiBaseUrl}${endpoint}`, {\r\n    method: 'DELETE',\r\n    headers: {\r\n      'accept': '*/*'\r\n    }\r\n  });\r\n  if (!response.ok) throw new Error('Network response was not ok');\r\n  return response.json();\r\n}\r\n  const [controlData, setControlData] = React.useState({\r\n    name: '',\r\n    description: '',\r\n    controlType: 'PREVENTIVE',\r\n    controlNature: 'MANUAL',\r\n    status: 'PLANNED',\r\n    effectiveness: 50,\r\n    ongoingCost: 0,\r\n    implementationDate: new Date().toISOString().split('T')[0],\r\n    targetCompletionDate: new Date().toISOString().split('T')[0],\r\n    reviewFrequency: 1,\r\n    operatingProcedure: '',\r\n    testingProcedure: '',\r\n    automated: false,\r\n    limitations: '',\r\n    dependencies: '',\r\n    ownerId: 0\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    const loadUsers = async () => {\r\n      try {\r\n        const usersData = await fetchData('/users');\r\n        setUsers(usersData.content || []);\r\n      } catch (error) {\r\n        console.error('Failed to load users:', error);\r\n      }\r\n    };\r\n    \r\n    loadUsers();\r\n  }, []);\r\n\r\n  const handleChange = (field, value) => {\r\n    setControlData(prev => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!controlData.name) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Control name is required',\r\n        severity: 'error'\r\n      });\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      setIsLoading(true);\r\n      await postData('/risk-controls/create', controlData);\r\n      \r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Control created successfully',\r\n        severity: 'success'\r\n      });\r\n      \r\n      // Redirect after a short delay\r\n      setTimeout(() => {\r\n        router.push('/risk-management/controls');\r\n      }, 1500);\r\n    } catch (error) {\r\n      setSnackbar({\r\n        open: true,\r\n        message: 'Failed to create control: ' + error.message,\r\n        severity: 'error'\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCloseSnackbar = () => {\r\n    setSnackbar(prev => ({ ...prev, open: false }));\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ p: 3 }}>\r\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>\r\n        <Typography variant=\"h4\">Create New Control</Typography>\r\n        \r\n        <Button\r\n          variant=\"outlined\"\r\n          startIcon={<IconArrowLeft size=\"1.1rem\" />}\r\n          onClick={() => router.push('/risk-management/controls')}\r\n        >\r\n          Back to Controls\r\n        </Button>\r\n      </Box>\r\n      \r\n      <Paper elevation={3} sx={{ p: 3 }}>\r\n        <ControlForm \r\n          controlData={controlData} \r\n          onChange={handleChange}\r\n          users={users}\r\n        />\r\n        \r\n        <Box sx={{ display: 'flex', justifyContent: 'flex-end', mt: 3 }}>\r\n          <Button\r\n            variant=\"contained\"\r\n            startIcon={<IconDeviceFloppy size=\"1.1rem\" />}\r\n            onClick={handleSubmit}\r\n            disabled={isLoading}\r\n          >\r\n            {isLoading ? 'Saving...' : 'Save Control'}\r\n          </Button>\r\n        </Box>\r\n      </Paper>\r\n      \r\n      <Snackbar\r\n        open={snackbar.open}\r\n        autoHideDuration={6000}\r\n        onClose={handleCloseSnackbar}\r\n        anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n      >\r\n        <Alert \r\n          onClose={handleCloseSnackbar} \r\n          severity={snackbar.severity}\r\n          sx={{ width: '100%' }}\r\n        >\r\n          {snackbar.message}\r\n        </Alert>\r\n      </Snackbar>\r\n    </Box>\r\n  );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 272, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}